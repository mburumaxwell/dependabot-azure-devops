using System.Text.Json.Serialization;

namespace Tingle.Dependabot.Models.GitHub;

public record GitHubPackage(
    [property: JsonPropertyName("name")] string Name,
    [property: JsonPropertyName("version")] string? Version);

public record GitHubSecurityAdvisory(
    [property: JsonPropertyName("identifiers")] List<SecurityAdvisoryIdentifier> Identifiers,
    [property: JsonPropertyName("severity")] string Severity,
    [property: JsonPropertyName("summary")] string Summary,
    [property: JsonPropertyName("description")] string Description,
    [property: JsonPropertyName("references")] List<string> References,
    [property: JsonPropertyName("cvss")] GitHubSecurityAdvisoryCvss Cvss,
    [property: JsonPropertyName("epss")] GitHubSecurityAdvisoryEpss Epss,
    [property: JsonPropertyName("cwes")] List<GitHubSecurityAdvisoryCwe> Cwes,
    [property: JsonPropertyName("publishedAt")] string PublishedAt,
    [property: JsonPropertyName("updatedAt")] string UpdatedAt,
    [property: JsonPropertyName("withdrawnAt")] string WithdrawnAt,
    [property: JsonPropertyName("permalink")] string Permalink);

public record SecurityAdvisoryIdentifier(
    [property: JsonPropertyName("type")] string Type,
    [property: JsonPropertyName("value")] string Value);

public record GitHubSecurityAdvisoryCvss(
    [property: JsonPropertyName("score")] double Score,
    [property: JsonPropertyName("vectorString")] string VectorString);

public record GitHubSecurityAdvisoryEpss(
    [property: JsonPropertyName("percentage")] double Percentage,
    [property: JsonPropertyName("percentile")] double Percentile);

public record GitHubSecurityAdvisoryCwe(
    [property: JsonPropertyName("id")] string Id,
    [property: JsonPropertyName("name")] string Name,
    [property: JsonPropertyName("description")] string Description);

public record GitHubSecurityVulnerability(
    [property: JsonPropertyName("ecosystem")] string Ecosystem,
    [property: JsonPropertyName("package")] GitHubPackage Package,
    [property: JsonPropertyName("advisory")] GitHubSecurityAdvisory Advisory,
    [property: JsonPropertyName("vulnerableVersionRange")] string VulnerableVersionRange,
    [property: JsonPropertyName("firstPatchedVersion")] string? FirstPatchedVersion);
